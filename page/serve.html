
<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/icons-extra.css"/>
		<link rel="stylesheet" type="text/css" href="../css/app.css"/>
	</head>

	<body id="serve">
		<header class="mui-bar mui-bar-nav head_bg">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left color_f"></a>
			<h1 class="mui-title color_f">
				产品
			</h1>
				<a id="search_input" class="mui-icon mui-icon-search mui-pull-right color_f"></a>
		</header>	
		<div class="mui-content" id="refreshContainer">
			<!--下拉刷新容器-->
		    <!--数据列表-->
		    <!--<ul class="mui-table-view mui-table-view-chevron">
		      
		    </ul>-->
			
			
			<!--选项卡-->
			<!--<div id="segmentedControl" class="mui-segmented-control">
				<a class="mui-control-item mui-active" href="#quanbu">
				           产品
				</a>
				<a class="mui-control-item" href="#jinpai">
					服务
				</a>
			</div>-->
			<div class="tab_item">
				<div id="quanbu" class="mui-control-content mui-active mui-scroll" >
					<ul class="mui-table-view mui-grid-view" id="qblist">
					    <!--<li class="mui-table-view-cell mui-media mui-col-xs-6">
					        <div class="bgf pbottom10">
					        	<a href="javascript:void(0)">
						            <img class="mui-media-object" src="../img/3ac79f3df8dcd100cab1840b788b4710b9122fee.jpg">
						            <div class="object-info">陆剑歌如约泛光灯凡是看过咯上分公司里的歌</div>
						            <div class="buy_count borbottom1">
						            	<span class="fl color_red f16"> &yen;466</span>
						            	<span class="fr color_b">1.9万人购买</span>
						            </div>
						            <div class="user-rating"><span>[用户评价]</span>陆剑歌如约泛光灯凡是看过咯上分公司里的歌陆剑歌如约泛光灯凡是看过咯上分公司里的歌</div>
						        </a>
					        </div>
					    </li>-->
					</ul>
					
					<!--全部服务列表渲染-->		
					<script type="text/html" id="qbserve">
					    {{each data as value i}}
						<li onclick="xiangqing('{{value.id}}')" class="mui-table-view-cell mui-media mui-col-xs-6 fw_item">
					        <div class="bgf pbottom10">
					        	<a href="javascript:void(0)">
						            <img class="mui-media-object" src="{{value.image}}">
						            <div class="object-info">{{value.title}}</div>
						            <div class="buy_count borbottom1">
						            	<span class="fl color_red f16"> &yen;{{value.price}}</span>
						            	<span class="fr color_b">{{value.people}}人购买</span>
						            </div>
						            <!--<div class="user-rating"><span>[用户评价]</span>{{value.comment}}</div>-->
						        </a>
					        </div>
					    </li>
						{{/each}}
					</script>
				</div>
				<!--<div id="jinpai" class="mui-control-content">
					<ul class="mui-table-view mui-grid-view" id="jplist">
					   
					</ul>
					
					<script type="text/html" id="jpserve">
					    {{each data as value i}}
						<li class="mui-table-view-cell mui-media mui-col-xs-6 fw_item" data-id="{{value.id}}">
					        <div class="bgf pbottom10">
					        	<a href="javascript:void(0)">
						            <img class="mui-media-object" src="{{value.image}}">
						            <div class="object-info">{{value.title}}</div>
						            <div class="buy_count borbottom1">
						            	<span class="fl color_red f16"> &yen;{{value.price}}</span>
						            	<span class="fr color_b">{{value.people}}人购买</span>
						            </div>
						            <div class="user-rating"><span>[用户评价]</span>{{value.comment}}</div>
						        </a>
					        </div>
					    </li>
						{{/each}}
					</script>
				</div>-->
			</div>
		</div>
		<script src="../js/jquery-1.11.3.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/request.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/template.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/mui.min.js"></script>
		<script src="../js/sub.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var num = 1;
			mui.init({ 
				 pullRefresh : {
				　　 swipeBack: false, //关闭左滑关闭功能
				    container:"#quanbu",//下拉刷新容器标识，querySelector能定位的css选择器均可，比如：id、.class等
				    up : {
					      height:500,//可选.默认50.触发上拉加载拖动距离
					      auto:false,//可选,默认false.自动上拉加载一次
					      contentrefresh : "正在加载...",//可选，正在加载状态时，上拉加载控件上显示的标题内容
					      contentnomore:'没有更多数据了',//可选，请求完毕若没有更多数据时显示的提醒内容；
					      callback :pullfresh
				   }
			   }
			});
			
			function pullfresh() {
				var that = this;
			     //业务逻辑代码，比如通过ajax从服务器获取新数据；
			    var shuju = $('#qblist').html();
			     shuaxin(num+=1);
			     $('#qblist').html(shuju+$('#qblist').html());
			     //注意：
			     //1、加载完新数据后，必须执行如下代码，true表示没有更多数据了：
			     //2、若为ajax请求，则需将如下代码放置在处理完ajax响应数据之后
			     setTimeout(function(){
			     	that.endPullupToRefresh(true);
			     },1000)
				

			}
			
		     	//			全部列表渲染js
		     	function shuaxin(num){
		     		  mui.ajax({
						url: WEB_HOST+"/index/products",
						type: "get",
						async: false,
						data:{
							"token":localStorage.getItem("token"),
							"pageNo":num,
						},
						dataType: "json",
						timeout: 1000,
						success: function(data) {
							console.log("产品"+JSON.stringify(data));
							if(data.status===0){
							   document.getElementById("qblist").innerHTML=template("qbserve",data);
							}else{
							   document.getElementById("qblist").innerHTML="<li>没有相关数据</li>";	
							}
						},error:function(a){
							mui.toast("服务器未响应，请稍后重试");
						}
					});
		     	}
              shuaxin(num);
//			金牌列表渲染js
//              mui.ajax({
//						url: WEB_HOST+"/index/jpservices",
//						type: "get",
//						async: false,
//						data:{"token":localStorage.getItem("token")},
//						dataType: "json",
//						timeout: 1000,
//						success: function(data) {
////							alert(JSON.stringify(data));
//							if(data.data.length>0){
//							   document.getElementById("jplist").innerHTML=template("jpserve",data);
//							}else{
//							   document.getElementById("jplist").innerHTML="<li>没有相关数据</li>";	
//							}
//						},error:function(a){
//							alert(a.status);
//						}
//				});
				function xiangqing(id){
					var listid=id;
					mui.openWindow({
		               url:"server-info.html",
		               id:"server-info",
		               createNew:true,
		               extras:{
				          listid:listid
				        }
	       			});
				}
//				var hd_list=document.getElementsByClassName("fw_item").length;
//				for(var i=0;i<hd_list;i++){
//					document.getElementsByClassName("fw_item")[i].addEventListener("tap",function(){
//						alert($(this).data("id"));
//						var listid=$(this).data("id");
//						 mui.openWindow({
//			               url:"server-info.html",
//			               id:"server-info",
//			               createNew:true,
//			               extras:{
//					          listid:listid
//					        }
//		       			});
//					})
//				}
				// 打开搜索界面
				document.querySelector('#search_input').addEventListener('tap', function () {
					mui.openWindow({
						url:"search.html",
						id:"search",
						createNew:true,
						 extras:{
					    	name:'chanpin'
					    },//在这里添加要传递的参数
					});
				})
					
		</script>
	</body>

</html>